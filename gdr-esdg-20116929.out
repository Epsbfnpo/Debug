Job 20116929 started at Wed 11 Feb 2026 08:57:46 PM AEDT
========================================================
üöÄ ÂêØÂä® ESDG ËÆ≠ÁªÉ‰ªªÂä° (Single Config Mode)
GPU Êï∞Èáè: 4
ÈÖçÁΩÆÊù•Ê∫ê: configs/defaults.py
========================================================
=========================================
üöÄ [Final Configuration] (Loaded from defaults.py)
=========================================
üöÄ [Final Configuration] (Loaded from defaults.py)
=========================================
üöÄ [Final Configuration] (Loaded from defaults.py)
ACCUM_ITER: 4
ALGORITHM: GDRNet
BACKBONE: FPT
BATCH_SIZE: 8
BLOCK_SIZE: 32
DATASET:
  IMBALANCE: False
  NAME: GDRBench
  NUM_CLASSES: 5
  ROOT: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
  SOURCE_DOMAINS: ('RLDR',)
  TARGET_DOMAINS: ('APTOS', 'DDR', 'DEEPDR', 'EYEPACS', 'FGADR', 'IDRID', 'MESSIDOR')
DG_MODE: ESDG
DROP_LAST: False
DROP_OUT: 0.0
EPOCHS: 100
FASTMOCO: 1.0
GDRNET:
  BETA: 0.1
  LAMBDA_DINO: 1.0
  LAMBDA_MASKED: 1.0
  LAMBDA_SDCLR: 0.5
  LAMBDA_SIAM: 0.0
  LAMBDA_SUP: 1.0
  MASKED: 0.5
  SCALING_FACTOR: 4.0
  SDCLR_ENABLE: True
  SDCLR_RATIO: 0.5
  TEMPERATURE: 0.1
INPUT:
  SIZE: 512
KD: 0.1
LEARNING_RATE: 0.00045
LOG_STEP: 5
MASKED: 0.5
MASK_RATIO: 0.5
MIXUP: False
MOCO_MOMENTUM: 0.999
MOCO_QUEUE_K: 1024
MODEL:
  FPT:
    HIGH_RES_SIZE: 512
    LAYERS_TO_EXTRACT: [0, 3, 6, 9]
    LOW_RES_SIZE: 224
    LPM_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
    SELECTION_RATIO: 0.5
    SIDE_LAYERS: 12
    SIDE_PRETRAINED_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
  NAME: 
MOMENTUM: 0.9
OPTIM:
  NAME: 
OUT_DIR: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/output_esdg_h100
OVERRIDE: True
P: 0.2
POSITIVE: 4
RANDOM: False
SEED: 42
SMOOTH: 0.4
SUP: 0.0
TIME_LIMIT: 86100
TRANSFORM:
  AUGPROB: 0.5
  COLORJITTER_B: 1.0
  COLORJITTER_C: 1.0
  COLORJITTER_H: 0.05
  COLORJITTER_S: 1.0
  FREQ: False
  NAME: []
  R: 0.0
  TEST_FREQ: False
USE_CUDA: True
VAL_EPOCH: 1
VERBOSE: True
WEIGHT_DECAY: 0.0001
WORKERS: 8
=========================================
ACCUM_ITER: 4
ALGORITHM: GDRNet
BACKBONE: FPT
BATCH_SIZE: 8
BLOCK_SIZE: 32
DATASET:
  IMBALANCE: False
  NAME: GDRBench
  NUM_CLASSES: 5
  ROOT: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
  SOURCE_DOMAINS: ('RLDR',)
  TARGET_DOMAINS: ('APTOS', 'DDR', 'DEEPDR', 'EYEPACS', 'FGADR', 'IDRID', 'MESSIDOR')
DG_MODE: ESDG
DROP_LAST: False
DROP_OUT: 0.0
EPOCHS: 100
FASTMOCO: 1.0
GDRNET:
  BETA: 0.1
  LAMBDA_DINO: 1.0
  LAMBDA_MASKED: 1.0
  LAMBDA_SDCLR: 0.5
  LAMBDA_SIAM: 0.0
  LAMBDA_SUP: 1.0
  MASKED: 0.5
  SCALING_FACTOR: 4.0
  SDCLR_ENABLE: True
  SDCLR_RATIO: 0.5
  TEMPERATURE: 0.1
INPUT:
  SIZE: 512
KD: 0.1
LEARNING_RATE: 0.00045
LOG_STEP: 5
MASKED: 0.5
MASK_RATIO: 0.5
MIXUP: False
MOCO_MOMENTUM: 0.999
MOCO_QUEUE_K: 1024
MODEL:
  FPT:
    HIGH_RES_SIZE: 512
    LAYERS_TO_EXTRACT: [0, 3, 6, 9]
    LOW_RES_SIZE: 224
    LPM_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
    SELECTION_RATIO: 0.5
    SIDE_LAYERS: 12
    SIDE_PRETRAINED_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
  NAME: 
MOMENTUM: 0.9
OPTIM:
  NAME: 
OUT_DIR: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/output_esdg_h100
OVERRIDE: True
P: 0.2
POSITIVE: 4
RANDOM: False
SEED: 42
SMOOTH: 0.4
SUP: 0.0
TIME_LIMIT: 86100
TRANSFORM:
  AUGPROB: 0.5
  COLORJITTER_B: 1.0
  COLORJITTER_C: 1.0
  COLORJITTER_H: 0.05
  COLORJITTER_S: 1.0
  FREQ: False
  NAME: []
  R: 0.0
  TEST_FREQ: False
USE_CUDA: True
VAL_EPOCH: 1
VERBOSE: True
WEIGHT_DECAY: 0.0001
WORKERS: 8
=========================================
ACCUM_ITER: 4
ALGORITHM: GDRNet
BACKBONE: FPT
BATCH_SIZE: 8
BLOCK_SIZE: 32
DATASET:
  IMBALANCE: False
  NAME: GDRBench
  NUM_CLASSES: 5
  ROOT: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
  SOURCE_DOMAINS: ('RLDR',)
  TARGET_DOMAINS: ('APTOS', 'DDR', 'DEEPDR', 'EYEPACS', 'FGADR', 'IDRID', 'MESSIDOR')
DG_MODE: ESDG
DROP_LAST: False
DROP_OUT: 0.0
EPOCHS: 100
FASTMOCO: 1.0
GDRNET:
  BETA: 0.1
  LAMBDA_DINO: 1.0
  LAMBDA_MASKED: 1.0
  LAMBDA_SDCLR: 0.5
  LAMBDA_SIAM: 0.0
  LAMBDA_SUP: 1.0
  MASKED: 0.5
  SCALING_FACTOR: 4.0
  SDCLR_ENABLE: True
  SDCLR_RATIO: 0.5
  TEMPERATURE: 0.1
INPUT:
  SIZE: 512
KD: 0.1
LEARNING_RATE: 0.00045
LOG_STEP: 5
MASKED: 0.5
MASK_RATIO: 0.5
MIXUP: False
MOCO_MOMENTUM: 0.999
MOCO_QUEUE_K: 1024
MODEL:
  FPT:
    HIGH_RES_SIZE: 512
    LAYERS_TO_EXTRACT: [0, 3, 6, 9]
    LOW_RES_SIZE: 224
    LPM_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
    SELECTION_RATIO: 0.5
    SIDE_LAYERS: 12
    SIDE_PRETRAINED_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
  NAME: 
MOMENTUM: 0.9
OPTIM:
  NAME: 
OUT_DIR: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/output_esdg_h100
OVERRIDE: True
P: 0.2
POSITIVE: 4
RANDOM: False
SEED: 42
SMOOTH: 0.4
SUP: 0.0
TIME_LIMIT: 86100
TRANSFORM:
  AUGPROB: 0.5
  COLORJITTER_B: 1.0
  COLORJITTER_C: 1.0
  COLORJITTER_H: 0.05
  COLORJITTER_S: 1.0
  FREQ: False
  NAME: []
  R: 0.0
  TEST_FREQ: False
USE_CUDA: True
VAL_EPOCH: 1
VERBOSE: True
WEIGHT_DECAY: 0.0001
WORKERS: 8=========================================

=========================================
üöÄ [Final Configuration] (Loaded from defaults.py)
ACCUM_ITER: 4
ALGORITHM: GDRNet
BACKBONE: FPT
BATCH_SIZE: 8
BLOCK_SIZE: 32
DATASET:
  IMBALANCE: False
  NAME: GDRBench
  NUM_CLASSES: 5
  ROOT: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
  SOURCE_DOMAINS: ('RLDR',)
  TARGET_DOMAINS: ('APTOS', 'DDR', 'DEEPDR', 'EYEPACS', 'FGADR', 'IDRID', 'MESSIDOR')
DG_MODE: ESDG
DROP_LAST: False
DROP_OUT: 0.0
EPOCHS: 100
FASTMOCO: 1.0
GDRNET:
  BETA: 0.1
  LAMBDA_DINO: 1.0
  LAMBDA_MASKED: 1.0
  LAMBDA_SDCLR: 0.5
  LAMBDA_SIAM: 0.0
  LAMBDA_SUP: 1.0
  MASKED: 0.5
  SCALING_FACTOR: 4.0
  SDCLR_ENABLE: True
  SDCLR_RATIO: 0.5
  TEMPERATURE: 0.1
INPUT:
  SIZE: 512
KD: 0.1
LEARNING_RATE: 0.00045
LOG_STEP: 5
MASKED: 0.5
MASK_RATIO: 0.5
MIXUP: False
MOCO_MOMENTUM: 0.999
MOCO_QUEUE_K: 1024
MODEL:
  FPT:
    HIGH_RES_SIZE: 512
    LAYERS_TO_EXTRACT: [0, 3, 6, 9]
    LOW_RES_SIZE: 224
    LPM_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
    SELECTION_RATIO: 0.5
    SIDE_LAYERS: 12
    SIDE_PRETRAINED_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
  NAME: 
MOMENTUM: 0.9
OPTIM:
  NAME: 
OUT_DIR: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/output_esdg_h100
OVERRIDE: True
P: 0.2
POSITIVE: 4
RANDOM: False
SEED: 42
SMOOTH: 0.4
SUP: 0.0
TIME_LIMIT: 86100
TRANSFORM:
  AUGPROB: 0.5
  COLORJITTER_B: 1.0
  COLORJITTER_C: 1.0
  COLORJITTER_H: 0.05
  COLORJITTER_S: 1.0
  FREQ: False
  NAME: []
  R: 0.0
  TEST_FREQ: False
USE_CUDA: True
VAL_EPOCH: 1
VERBOSE: True
WEIGHT_DECAY: 0.0001
WORKERS: 8
=========================================
0 iterations per epoch
We have 0 images in train set, 0 images in val set, and 0 images in test set.
Namespace(local_rank=0, opts=[], device=device(type='cuda', index=0))
ACCUM_ITER: 4
ALGORITHM: GDRNet
BACKBONE: FPT
BATCH_SIZE: 8
BLOCK_SIZE: 32
DATASET:
  IMBALANCE: False
  NAME: GDRBench
  NUM_CLASSES: 5
  ROOT: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
  SOURCE_DOMAINS: ('RLDR',)
  TARGET_DOMAINS: ('APTOS', 'DDR', 'DEEPDR', 'EYEPACS', 'FGADR', 'IDRID', 'MESSIDOR')
DG_MODE: ESDG
DROP_LAST: False
DROP_OUT: 0.0
EPOCHS: 100
FASTMOCO: 1.0
GDRNET:
  BETA: 0.1
  LAMBDA_DINO: 1.0
  LAMBDA_MASKED: 1.0
  LAMBDA_SDCLR: 0.5
  LAMBDA_SIAM: 0.0
  LAMBDA_SUP: 1.0
  MASKED: 0.5
  SCALING_FACTOR: 4.0
  SDCLR_ENABLE: True
  SDCLR_RATIO: 0.5
  TEMPERATURE: 0.1
INPUT:
  SIZE: 512
KD: 0.1
LEARNING_RATE: 0.00045
LOG_STEP: 5
MASKED: 0.5
MASK_RATIO: 0.5
MIXUP: False
MOCO_MOMENTUM: 0.999
MOCO_QUEUE_K: 1024
MODEL:
  FPT:
    HIGH_RES_SIZE: 512
    LAYERS_TO_EXTRACT: [0, 3, 6, 9]
    LOW_RES_SIZE: 224
    LPM_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
    SELECTION_RATIO: 0.5
    SIDE_LAYERS: 12
    SIDE_PRETRAINED_PATH: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
  NAME: 
MOMENTUM: 0.9
OPTIM:
  NAME: 
OUT_DIR: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/output_esdg_h100
OVERRIDE: True
P: 0.2
POSITIVE: 4
RANDOM: False
SEED: 42
SMOOTH: 0.4
SUP: 0.0
TIME_LIMIT: 86100
TRANSFORM:
  AUGPROB: 0.5
  COLORJITTER_B: 1.0
  COLORJITTER_C: 1.0
  COLORJITTER_H: 0.05
  COLORJITTER_S: 1.0
  FREQ: False
  NAME: []
  R: 0.0
  TEST_FREQ: False
USE_CUDA: True
VAL_EPOCH: 1
VERBOSE: True
WEIGHT_DECAY: 0.0001
WORKERS: 8
Distributed: True, Rank: 0
[INFO] Log Path (Absolute): /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/output_esdg_h100
[21:00:22][Rank 0] Loading datasets...
[TRAIN] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[TRAIN] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
[21:00:22][Rank 1] Loading datasets...
[21:00:22][Rank 3] Loading datasets...
[21:00:22][Rank 2] Loading datasets...
[TRAIN] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[TRAIN] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
[TRAIN] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[TRAIN] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
[TRAIN] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[TRAIN] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
‚úÖ [TRAIN] Successfully loaded 1275 images.‚úÖ [TRAIN] Successfully loaded 1275 images.
‚úÖ [TRAIN] Successfully loaded 1275 images.
   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/RLDR/moderate_npdr/17373_left.jpg
   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/RLDR/moderate_npdr/17373_left.jpg

   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/RLDR/moderate_npdr/17373_left.jpg   Sample Mask:  /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/masks/RLDR/moderate_npdr/17373_left.jpg   Sample Mask:  /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/masks/RLDR/moderate_npdr/17373_left.jpg


   Sample Mask:  /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/masks/RLDR/moderate_npdr/17373_left.jpg
‚úÖ [TRAIN] Successfully loaded 1275 images.
   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/RLDR/moderate_npdr/17373_left.jpg
   Sample Mask:  /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/masks/RLDR/moderate_npdr/17373_left.jpg
[VAL] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data[VAL] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data

[VAL] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits[VAL] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits

[VAL] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[VAL] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
[VAL] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[VAL] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
‚úÖ [VAL] Successfully loaded 318 images.
   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/RLDR/moderate_npdr/27260_left.jpg
‚úÖ [VAL] Successfully loaded 318 images.
   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/RLDR/moderate_npdr/27260_left.jpg‚úÖ [VAL] Successfully loaded 318 images.
‚úÖ [VAL] Successfully loaded 318 images.

   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/RLDR/moderate_npdr/27260_left.jpg   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/RLDR/moderate_npdr/27260_left.jpg

[TEST] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[TEST] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
[TEST] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[TEST] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
[TEST] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[TEST] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
[TEST] Dataset Root: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data
[TEST] Loading splits from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/splits
‚úÖ [TEST] Successfully loaded 57012 images.‚úÖ [TEST] Successfully loaded 57012 images.‚úÖ [TEST] Successfully loaded 57012 images.


‚úÖ [TEST] Successfully loaded 57012 images.   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/APTOS/nodr/63e041a757eb.png   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/APTOS/nodr/63e041a757eb.png   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/APTOS/nodr/63e041a757eb.png



   Sample Image: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/GDR_Formatted_Data/images/APTOS/nodr/63e041a757eb.png
Loading Frozen Encoder: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading Frozen Encoder: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading Frozen Encoder: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading Frozen Encoder: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading ViT Backbone from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading ViT Backbone from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading ViT Backbone from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading ViT Backbone from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
>> [Optimization] Enabling Gradient Checkpointing for LoRA training...
>> [Optimization] Enabling Gradient Checkpointing for LoRA training...>> [Optimization] Enabling Gradient Checkpointing for LoRA training...

>> [Optimization] Enabling Gradient Checkpointing for LoRA training...
>> [DINOv3 Adapt] Injecting LoRA (Rank=8)...
>> [DINOv3 Adapt] Injecting LoRA (Rank=8)...
>> [DINOv3 Adapt] Injecting LoRA (Rank=8)...
>> [DINOv3 Adapt] Injecting LoRA (Rank=8)...
>> [DINOv3 Adapt] LoRA Enabled. Trainable Params: 294912 / 85955328 (0.34%)
Initializing Side Network: SideResNet50 with Fusion (LPM dim: 768)
>> [DINOv3 Adapt] LoRA Enabled. Trainable Params: 294912 / 85955328 (0.34%)
>> [DINOv3 Adapt] LoRA Enabled. Trainable Params: 294912 / 85955328 (0.34%)>> [DINOv3 Adapt] LoRA Enabled. Trainable Params: 294912 / 85955328 (0.34%)
Initializing Side Network: SideResNet50 with Fusion (LPM dim: 768)

Initializing Side Network: SideResNet50 with Fusion (LPM dim: 768)
Initializing Side Network: SideResNet50 with Fusion (LPM dim: 768)
>> [SideResNet] Loading pretrained weights from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
>> [SideResNet] Loading pretrained weights from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
>> [SideResNet] Loading pretrained weights from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
>> [SideResNet] Loading pretrained weights from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
>> [SideResNet] Pretrained weights loaded successfully.
>> [SideResNet] Pretrained weights loaded successfully.
>> [SideResNet] Pretrained weights loaded successfully.
>> [SideResNet] Pretrained weights loaded successfully.
>> [Optimizer Info] Detected FPT, switching to AdamW optimizer.
Loading Frozen Encoder: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
>> [Optimizer Info] Detected FPT, switching to AdamW optimizer.
Loading Frozen Encoder: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading ViT Backbone from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading ViT Backbone from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
>> [Optimizer Info] Detected FPT, switching to AdamW optimizer.
Loading Frozen Encoder: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
Loading ViT Backbone from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
>> [Optimizer Info] Detected FPT, switching to AdamW optimizer.
Loading Frozen Encoder: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
>> [Optimization] Enabling Gradient Checkpointing for LoRA training...
>> [DINOv3 Adapt] Injecting LoRA (Rank=8)...
Loading ViT Backbone from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/dinov3_vitb16
>> [DINOv3 Adapt] LoRA Enabled. Trainable Params: 294912 / 85955328 (0.34%)
Initializing Side Network: SideResNet50 with Fusion (LPM dim: 768)
>> [Optimization] Enabling Gradient Checkpointing for LoRA training...
>> [DINOv3 Adapt] Injecting LoRA (Rank=8)...
>> [DINOv3 Adapt] LoRA Enabled. Trainable Params: 294912 / 85955328 (0.34%)
Initializing Side Network: SideResNet50 with Fusion (LPM dim: 768)
>> [Optimization] Enabling Gradient Checkpointing for LoRA training...
>> [DINOv3 Adapt] Injecting LoRA (Rank=8)...
>> [DINOv3 Adapt] LoRA Enabled. Trainable Params: 294912 / 85955328 (0.34%)
Initializing Side Network: SideResNet50 with Fusion (LPM dim: 768)
>> [Optimization] Enabling Gradient Checkpointing for LoRA training...
>> [DINOv3 Adapt] Injecting LoRA (Rank=8)...
>> [DINOv3 Adapt] LoRA Enabled. Trainable Params: 294912 / 85955328 (0.34%)
Initializing Side Network: SideResNet50 with Fusion (LPM dim: 768)
>> [SideResNet] Loading pretrained weights from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
>> [SideResNet] Loading pretrained weights from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
>> [SideResNet] Loading pretrained weights from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
>> [SideResNet] Loading pretrained weights from: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/checkpoints/resnet50-19c8e357.pth
>> [SideResNet] Pretrained weights loaded successfully.
>> [SideResNet] Pretrained weights loaded successfully.
>> [SideResNet] Pretrained weights loaded successfully.
>> [SideResNet] Pretrained weights loaded successfully.
>> [GDRNet] Initializing DINOv3-FD Full Suite...
>> [GDRNet] Initializing DINOv3-FD Full Suite...
>> [Optimization] H100 Detected. Switching to BFloat16 Training.
>> [GDRNet] Hook registered on SideResNet layer4 for Attention Transfer.
>> [Optimization] H100 Detected. Switching to BFloat16 Training.
>> [GDRNet] Hook registered on SideResNet layer4 for Attention Transfer.
[21:01:04][Rank 2] SyncBatchNorm Activated.
>> [GDRNet] Initializing DINOv3-FD Full Suite...
>> [GDRNet] Initializing DINOv3-FD Full Suite...
>> [Optimization] H100 Detected. Switching to BFloat16 Training.
>> [GDRNet] Hook registered on SideResNet layer4 for Attention Transfer.
>> [Optimization] H100 Detected. Switching to BFloat16 Training.
>> [GDRNet] Hook registered on SideResNet layer4 for Attention Transfer.
[21:01:04][Rank 0] SyncBatchNorm Activated.
[21:01:04][Rank 1] SyncBatchNorm Activated.
[21:01:04][Rank 3] SyncBatchNorm Activated.

[DEBUG] ‚ùå Checkpoint NOT found at: /datasets/work/hb-nhmrc-dhcp/work/liu275/DGDR/output_esdg_h100/latest_model.pth
[21:01:06][Rank 3] No checkpoints found. Starting from scratch.[21:01:06][Rank 1] No checkpoints found. Starting from scratch.[21:01:06][Rank 0] No checkpoints found. Starting from scratch.


[21:01:06][Rank 2] No checkpoints found. Starting from scratch.
epoch: 1, loss: 5.0731, cls: 1.2720, distill: 0.0749, contrast: 4.9173, ortho: 0.0067, at: 0.0006, neg: 0.0809
Starting validation...
val - epoch: 1, loss: 1.1338, acc: 0.5687, auc: 0.6954, F1: 0.1453, QWK: 0.0094.
Epoch: 1 | Val AUC: 0.6954 | Test Skipped
Saving best model...
Best Val AUC: 0.6954 (Model Saved)
epoch: 2, loss: 4.9562, cls: 1.0787, distill: 0.0723, contrast: 5.2244, ortho: 0.0003, at: 0.0005, neg: 0.1505
Starting validation...
val - epoch: 2, loss: 1.3913, acc: 0.5875, auc: 0.6664, F1: 0.1795, QWK: 0.0373.
Epoch: 2 | Val AUC: 0.6664 | Test Skipped
epoch: 3, loss: 5.1647, cls: 1.1648, distill: 0.1002, contrast: 5.3137, ortho: 0.0004, at: 0.0005, neg: 0.1356
Starting validation...
val - epoch: 3, loss: 1.2066, acc: 0.5750, auc: 0.7521, F1: 0.2561, QWK: 0.1044.
Epoch: 3 | Val AUC: 0.7521 | Test Skipped
Saving best model...
Best Val AUC: 0.7521 (Model Saved)
epoch: 4, loss: 4.9269, cls: 1.1091, distill: 0.0925, contrast: 5.1199, ortho: 0.0002, at: 0.0005, neg: 0.0886
Starting validation...
val - epoch: 4, loss: 1.0586, acc: 0.6219, auc: 0.7515, F1: 0.3028, QWK: 0.3190.
Epoch: 4 | Val AUC: 0.7515 | Test Skipped
epoch: 5, loss: 4.6208, cls: 0.9317, distill: 0.0663, contrast: 5.0960, ortho: 0.0001, at: 0.0005, neg: 0.0509
Starting validation...
val - epoch: 5, loss: 1.0234, acc: 0.6094, auc: 0.8313, F1: 0.3633, QWK: 0.2964.
Epoch: 5 | Val AUC: 0.8313 | Test Skipped
Saving best model...
Best Val AUC: 0.8313 (Model Saved)
epoch: 6, loss: 4.6082, cls: 0.9941, distill: 0.0538, contrast: 4.9921, ortho: 0.0001, at: 0.0005, neg: 0.0277
Starting validation...
val - epoch: 6, loss: 0.9987, acc: 0.6031, auc: 0.8327, F1: 0.4617, QWK: 0.4994.
Epoch: 6 | Val AUC: 0.8327 | Test Skipped
Saving best model...
Best Val AUC: 0.8327 (Model Saved)
epoch: 7, loss: 4.5631, cls: 0.9785, distill: 0.0615, contrast: 4.9909, ortho: 0.0002, at: 0.0005, neg: 0.0140
Starting validation...
val - epoch: 7, loss: 2.4203, acc: 0.3125, auc: 0.7498, F1: 0.2253, QWK: 0.3072.
Epoch: 7 | Val AUC: 0.7498 | Test Skipped
epoch: 8, loss: 4.5545, cls: 0.9793, distill: 0.1009, contrast: 4.9701, ortho: 0.0001, at: 0.0005, neg: 0.0070
Starting validation...
val - epoch: 8, loss: 0.9208, acc: 0.6250, auc: 0.8206, F1: 0.3015, QWK: 0.3959.
Epoch: 8 | Val AUC: 0.8206 | Test Skipped
epoch: 9, loss: 4.6046, cls: 1.0357, distill: 0.1331, contrast: 4.9454, ortho: 0.0002, at: 0.0005, neg: 0.0050
Starting validation...
val - epoch: 9, loss: 1.0725, acc: 0.5750, auc: 0.8446, F1: 0.3853, QWK: 0.5272.
Epoch: 9 | Val AUC: 0.8446 | Test Skipped
Saving best model...
Best Val AUC: 0.8446 (Model Saved)
epoch: 10, loss: 4.3535, cls: 0.8573, distill: 0.1404, contrast: 4.8642, ortho: 0.0004, at: 0.0005, neg: 0.0024
Starting validation...
val - epoch: 10, loss: 1.0187, acc: 0.6375, auc: 0.8518, F1: 0.4326, QWK: 0.4024.
Epoch: 10 | Val AUC: 0.8518 | Test Skipped
Saving best model...
Best Val AUC: 0.8518 (Model Saved)
epoch: 11, loss: 4.4729, cls: 0.8937, distill: 0.1563, contrast: 4.9648, ortho: 0.0004, at: 0.0005, neg: 0.0027
Starting validation...
val - epoch: 11, loss: 1.0723, acc: 0.6031, auc: 0.8507, F1: 0.3269, QWK: 0.1622.
Epoch: 11 | Val AUC: 0.8507 | Test Skipped
epoch: 12, loss: 4.4044, cls: 0.8549, distill: 0.1461, contrast: 4.9087, ortho: 0.0001, at: 0.0005, neg: 0.0027
Starting validation...
val - epoch: 12, loss: 1.0468, acc: 0.6250, auc: 0.8622, F1: 0.4269, QWK: 0.4456.
Epoch: 12 | Val AUC: 0.8622 | Test Skipped
Saving best model...
Best Val AUC: 0.8622 (Model Saved)
epoch: 13, loss: 4.2140, cls: 0.7895, distill: 0.1235, contrast: 4.7617, ortho: 0.0001, at: 0.0005, neg: 0.0033
Starting validation...
val - epoch: 13, loss: 1.0009, acc: 0.6250, auc: 0.8612, F1: 0.4239, QWK: 0.4736.
Epoch: 13 | Val AUC: 0.8612 | Test Skipped
epoch: 14, loss: 4.3116, cls: 0.8390, distill: 0.1251, contrast: 4.8350, ortho: 0.0001, at: 0.0005, neg: 0.0031
Starting validation...
val - epoch: 14, loss: 1.1941, acc: 0.6000, auc: 0.8533, F1: 0.3549, QWK: 0.2226.
Epoch: 14 | Val AUC: 0.8533 | Test Skipped
epoch: 15, loss: 4.1632, cls: 0.8300, distill: 0.1320, contrast: 4.6322, ortho: 0.0000, at: 0.0005, neg: 0.0029
Starting validation...
val - epoch: 15, loss: 0.8854, acc: 0.6531, auc: 0.8586, F1: 0.5143, QWK: 0.5694.
Epoch: 15 | Val AUC: 0.8586 | Test Skipped
epoch: 16, loss: 4.2616, cls: 0.9552, distill: 0.1340, contrast: 4.4119, ortho: 0.0000, at: 0.0005, neg: 0.0022
Starting validation...
val - epoch: 16, loss: 0.9203, acc: 0.6406, auc: 0.8610, F1: 0.4340, QWK: 0.4968.
Epoch: 16 | Val AUC: 0.8610 | Test Skipped
epoch: 17, loss: 4.2563, cls: 0.9024, distill: 0.1240, contrast: 4.5618, ortho: 0.0002, at: 0.0005, neg: 0.0026
Starting validation...
val - epoch: 17, loss: 0.9469, acc: 0.6406, auc: 0.8523, F1: 0.3632, QWK: 0.4228.
Epoch: 17 | Val AUC: 0.8523 | Test Skipped
epoch: 18, loss: 4.2340, cls: 0.8681, distill: 0.1279, contrast: 4.5964, ortho: 0.0001, at: 0.0005, neg: 0.0025
Starting validation...
val - epoch: 18, loss: 1.2173, acc: 0.5906, auc: 0.8522, F1: 0.3492, QWK: 0.2552.
Epoch: 18 | Val AUC: 0.8522 | Test Skipped
epoch: 19, loss: 4.2254, cls: 0.8592, distill: 0.1074, contrast: 4.6091, ortho: 0.0001, at: 0.0005, neg: 0.0024
Starting validation...
val - epoch: 19, loss: 1.0117, acc: 0.6281, auc: 0.8636, F1: 0.4361, QWK: 0.3978.
Epoch: 19 | Val AUC: 0.8636 | Test Skipped
Saving best model...
Best Val AUC: 0.8636 (Model Saved)
epoch: 20, loss: 4.2290, cls: 0.8702, distill: 0.1416, contrast: 4.5502, ortho: 0.0002, at: 0.0005, neg: 0.0020
Starting validation...
val - epoch: 20, loss: 1.0190, acc: 0.6281, auc: 0.8584, F1: 0.4844, QWK: 0.5269.
Epoch: 20 | Val AUC: 0.8584 | Test Skipped
epoch: 21, loss: 4.0037, cls: 0.7881, distill: 0.1171, contrast: 4.3957, ortho: 0.0001, at: 0.0005, neg: 0.0025
Starting validation...
val - epoch: 21, loss: 0.8451, acc: 0.6312, auc: 0.8560, F1: 0.4608, QWK: 0.5054.
Epoch: 21 | Val AUC: 0.8560 | Test Skipped
epoch: 22, loss: 4.1660, cls: 0.8562, distill: 0.1558, contrast: 4.4127, ortho: 0.0001, at: 0.0005, neg: 0.0035
Starting validation...
val - epoch: 22, loss: 1.0000, acc: 0.6719, auc: 0.8628, F1: 0.4966, QWK: 0.4916.
Epoch: 22 | Val AUC: 0.8628 | Test Skipped
epoch: 23, loss: 4.2495, cls: 0.8298, distill: 0.2354, contrast: 4.5173, ortho: 0.0001, at: 0.0005, neg: 0.0036
Starting validation...
val - epoch: 23, loss: 0.9951, acc: 0.6469, auc: 0.8651, F1: 0.4265, QWK: 0.4693.
Epoch: 23 | Val AUC: 0.8651 | Test Skipped
Saving best model...
Best Val AUC: 0.8651 (Model Saved)
epoch: 24, loss: 4.3314, cls: 0.8740, distill: 0.2413, contrast: 4.4267, ortho: 0.0001, at: 0.0005, neg: 0.0030
Starting validation...
val - epoch: 24, loss: 1.0098, acc: 0.6438, auc: 0.8675, F1: 0.4260, QWK: 0.3902.
Epoch: 24 | Val AUC: 0.8675 | Test Skipped
Saving best model...
Best Val AUC: 0.8675 (Model Saved)
epoch: 25, loss: 4.2781, cls: 0.8331, distill: 0.1657, contrast: 4.5856, ortho: 0.0000, at: 0.0005, neg: 0.0029
Starting validation...
val - epoch: 25, loss: 1.1956, acc: 0.5906, auc: 0.8590, F1: 0.3221, QWK: 0.2783.
Epoch: 25 | Val AUC: 0.8590 | Test Skipped
epoch: 26, loss: 4.2168, cls: 0.8263, distill: 0.2300, contrast: 4.4022, ortho: 0.0001, at: 0.0005, neg: 0.0025
Starting validation...
val - epoch: 26, loss: 0.8930, acc: 0.6375, auc: 0.8686, F1: 0.4551, QWK: 0.5502.
Epoch: 26 | Val AUC: 0.8686 | Test Skipped
Saving best model...
Best Val AUC: 0.8686 (Model Saved)
epoch: 27, loss: 3.9766, cls: 0.8500, distill: 0.1225, contrast: 4.1183, ortho: 0.0001, at: 0.0005, neg: 0.0029
Starting validation...
val - epoch: 27, loss: 0.8846, acc: 0.6406, auc: 0.8694, F1: 0.4569, QWK: 0.5159.
Epoch: 27 | Val AUC: 0.8694 | Test Skipped
Saving best model...
Best Val AUC: 0.8694 (Model Saved)
epoch: 28, loss: 4.0188, cls: 0.8580, distill: 0.1282, contrast: 4.1776, ortho: 0.0000, at: 0.0005, neg: 0.0030
Starting validation...
val - epoch: 28, loss: 0.9812, acc: 0.6594, auc: 0.8729, F1: 0.4881, QWK: 0.5103.
Epoch: 28 | Val AUC: 0.8729 | Test Skipped
Saving best model...
Best Val AUC: 0.8729 (Model Saved)
epoch: 29, loss: 4.2771, cls: 0.9509, distill: 0.1296, contrast: 4.3912, ortho: 0.0001, at: 0.0005, neg: 0.0026
Starting validation...
val - epoch: 29, loss: 0.9095, acc: 0.6500, auc: 0.8592, F1: 0.4182, QWK: 0.4546.
Epoch: 29 | Val AUC: 0.8592 | Test Skipped
epoch: 30, loss: 4.1262, cls: 0.8584, distill: 0.1456, contrast: 4.3441, ortho: 0.0001, at: 0.0005, neg: 0.0032
Starting validation...
val - epoch: 30, loss: 1.1711, acc: 0.6031, auc: 0.8632, F1: 0.3821, QWK: 0.3422.
Epoch: 30 | Val AUC: 0.8632 | Test Skipped
epoch: 31, loss: 4.2746, cls: 0.8696, distill: 0.1353, contrast: 4.5610, ortho: 0.0000, at: 0.0005, neg: 0.0028
Starting validation...
val - epoch: 31, loss: 0.8245, acc: 0.6469, auc: 0.8644, F1: 0.4089, QWK: 0.4715.
Epoch: 31 | Val AUC: 0.8644 | Test Skipped
epoch: 32, loss: 3.9400, cls: 0.7763, distill: 0.1063, contrast: 4.2269, ortho: 0.0001, at: 0.0005, neg: 0.0023
Starting validation...
val - epoch: 32, loss: 1.0130, acc: 0.6562, auc: 0.8704, F1: 0.4761, QWK: 0.4848.
Epoch: 32 | Val AUC: 0.8704 | Test Skipped
epoch: 33, loss: 3.9649, cls: 0.8247, distill: 0.1016, contrast: 4.1771, ortho: 0.0003, at: 0.0005, neg: 0.0031
Starting validation...
val - epoch: 33, loss: 0.8457, acc: 0.6500, auc: 0.8657, F1: 0.4192, QWK: 0.4576.
Epoch: 33 | Val AUC: 0.8657 | Test Skipped
epoch: 34, loss: 3.9849, cls: 0.7954, distill: 0.1101, contrast: 4.2585, ortho: 0.0007, at: 0.0005, neg: 0.0086
Starting validation...
val - epoch: 34, loss: 1.0334, acc: 0.6781, auc: 0.8741, F1: 0.5037, QWK: 0.5372.
Epoch: 34 | Val AUC: 0.8741 | Test Skipped
Saving best model...
Best Val AUC: 0.8741 (Model Saved)
epoch: 35, loss: 4.0803, cls: 0.8592, distill: 0.1132, contrast: 4.2989, ortho: 0.0005, at: 0.0005, neg: 0.0093
Starting validation...
val - epoch: 35, loss: 0.8692, acc: 0.6469, auc: 0.8721, F1: 0.4071, QWK: 0.4898.
Epoch: 35 | Val AUC: 0.8721 | Test Skipped
epoch: 36, loss: 4.2293, cls: 0.8536, distill: 0.1539, contrast: 4.4913, ortho: 0.0005, at: 0.0005, neg: 0.0062
Starting validation...
val - epoch: 36, loss: 0.8860, acc: 0.6406, auc: 0.8729, F1: 0.4280, QWK: 0.5226.
Epoch: 36 | Val AUC: 0.8729 | Test Skipped
epoch: 37, loss: 4.0540, cls: 0.7760, distill: 0.1430, contrast: 4.4126, ortho: 0.0002, at: 0.0005, neg: 0.0045
Starting validation...
val - epoch: 37, loss: 0.9536, acc: 0.6562, auc: 0.8701, F1: 0.4588, QWK: 0.5726.
Epoch: 37 | Val AUC: 0.8701 | Test Skipped
epoch: 38, loss: 4.0306, cls: 0.8501, distill: 0.1395, contrast: 4.1073, ortho: 0.0001, at: 0.0005, neg: 0.0030
Starting validation...
val - epoch: 38, loss: 0.9033, acc: 0.6531, auc: 0.8682, F1: 0.4593, QWK: 0.5465.
Epoch: 38 | Val AUC: 0.8682 | Test Skipped
epoch: 39, loss: 3.9562, cls: 0.8071, distill: 0.0964, contrast: 4.1131, ortho: 0.0000, at: 0.0005, neg: 0.0030
Starting validation...
val - epoch: 39, loss: 0.9123, acc: 0.6188, auc: 0.8701, F1: 0.4609, QWK: 0.5009.
Epoch: 39 | Val AUC: 0.8701 | Test Skipped
epoch: 40, loss: 3.9182, cls: 0.8015, distill: 0.0790, contrast: 4.2393, ortho: 0.0000, at: 0.0005, neg: 0.0043
Starting validation...
val - epoch: 40, loss: 0.8277, acc: 0.6500, auc: 0.8707, F1: 0.4802, QWK: 0.5675.
Epoch: 40 | Val AUC: 0.8707 | Test Skipped
epoch: 41, loss: 3.8933, cls: 0.7714, distill: 0.1316, contrast: 4.1484, ortho: 0.0000, at: 0.0005, neg: 0.0040
Starting validation...
val - epoch: 41, loss: 0.9105, acc: 0.6469, auc: 0.8753, F1: 0.4238, QWK: 0.4075.
Epoch: 41 | Val AUC: 0.8753 | Test Skipped
Saving best model...
Best Val AUC: 0.8753 (Model Saved)
epoch: 42, loss: 3.9511, cls: 0.7426, distill: 0.1678, contrast: 4.1936, ortho: 0.0000, at: 0.0005, neg: 0.0036
Starting validation...
val - epoch: 42, loss: 0.8395, acc: 0.6781, auc: 0.8806, F1: 0.5374, QWK: 0.5244.
Epoch: 42 | Val AUC: 0.8806 | Test Skipped
Saving best model...
Best Val AUC: 0.8806 (Model Saved)
epoch: 43, loss: 4.0485, cls: 0.7694, distill: 0.2073, contrast: 4.2575, ortho: 0.0000, at: 0.0005, neg: 0.0031
Starting validation...
val - epoch: 43, loss: 0.8717, acc: 0.6375, auc: 0.8724, F1: 0.4811, QWK: 0.5984.
Epoch: 43 | Val AUC: 0.8724 | Test Skipped
epoch: 44, loss: 3.9057, cls: 0.6800, distill: 0.2246, contrast: 4.1452, ortho: 0.0000, at: 0.0005, neg: 0.0028
Starting validation...
val - epoch: 44, loss: 0.9363, acc: 0.6531, auc: 0.8796, F1: 0.4886, QWK: 0.5171.
Epoch: 44 | Val AUC: 0.8796 | Test Skipped
epoch: 45, loss: 3.8595, cls: 0.7279, distill: 0.1180, contrast: 4.1576, ortho: 0.0000, at: 0.0005, neg: 0.0029
Starting validation...
val - epoch: 45, loss: 0.8848, acc: 0.6406, auc: 0.8657, F1: 0.3631, QWK: 0.5050.
Epoch: 45 | Val AUC: 0.8657 | Test Skipped
epoch: 46, loss: 3.8267, cls: 0.7184, distill: 0.1320, contrast: 4.1167, ortho: 0.0000, at: 0.0005, neg: 0.0038
Starting validation...
val - epoch: 46, loss: 0.8400, acc: 0.6625, auc: 0.8765, F1: 0.4424, QWK: 0.4875.
Epoch: 46 | Val AUC: 0.8765 | Test Skipped
epoch: 47, loss: 4.1905, cls: 0.8278, distill: 0.1859, contrast: 4.2950, ortho: 0.0000, at: 0.0005, neg: 0.0036
Starting validation...
val - epoch: 47, loss: 0.8478, acc: 0.6750, auc: 0.8818, F1: 0.4992, QWK: 0.5926.
Epoch: 47 | Val AUC: 0.8818 | Test Skipped
Saving best model...
Best Val AUC: 0.8818 (Model Saved)
epoch: 48, loss: 4.0481, cls: 0.7776, distill: 0.2106, contrast: 4.1830, ortho: 0.0000, at: 0.0005, neg: 0.0036
Starting validation...
val - epoch: 48, loss: 0.9504, acc: 0.6594, auc: 0.8827, F1: 0.4484, QWK: 0.4013.
Epoch: 48 | Val AUC: 0.8827 | Test Skipped
Saving best model...
Best Val AUC: 0.8827 (Model Saved)
epoch: 49, loss: 4.0601, cls: 0.8419, distill: 0.1872, contrast: 4.1236, ortho: 0.0000, at: 0.0005, neg: 0.0022
Starting validation...
val - epoch: 49, loss: 0.9546, acc: 0.6750, auc: 0.8840, F1: 0.5075, QWK: 0.6040.
Epoch: 49 | Val AUC: 0.8840 | Test Skipped
Saving best model...
Best Val AUC: 0.8840 (Model Saved)
epoch: 50, loss: 3.8594, cls: 0.7432, distill: 0.1190, contrast: 4.1309, ortho: 0.0000, at: 0.0005, neg: 0.0017
Starting validation...
val - epoch: 50, loss: 0.8481, acc: 0.6531, auc: 0.8674, F1: 0.4135, QWK: 0.5461.
Epoch: 50 | Val AUC: 0.8674 | Test Skipped
epoch: 51, loss: 3.8203, cls: 0.7553, distill: 0.1439, contrast: 3.9451, ortho: 0.0000, at: 0.0005, neg: 0.0020
Starting validation...
val - epoch: 51, loss: 0.9891, acc: 0.6562, auc: 0.8843, F1: 0.4656, QWK: 0.4341.
Epoch: 51 | Val AUC: 0.8843 | Test Skipped
Saving best model...
Best Val AUC: 0.8843 (Model Saved)
epoch: 52, loss: 3.9439, cls: 0.7995, distill: 0.1303, contrast: 4.1869, ortho: 0.0000, at: 0.0005, neg: 0.0017
Starting validation...
val - epoch: 52, loss: 0.8120, acc: 0.6719, auc: 0.8807, F1: 0.5340, QWK: 0.6079.
Epoch: 52 | Val AUC: 0.8807 | Test Skipped
epoch: 53, loss: 3.9794, cls: 0.7731, distill: 0.2148, contrast: 4.1176, ortho: 0.0000, at: 0.0005, neg: 0.0019
Starting validation...
val - epoch: 53, loss: 0.8981, acc: 0.6500, auc: 0.8973, F1: 0.5034, QWK: 0.6220.
Epoch: 53 | Val AUC: 0.8973 | Test Skipped
Saving best model...
Best Val AUC: 0.8973 (Model Saved)
epoch: 54, loss: 4.1183, cls: 0.8433, distill: 0.2283, contrast: 4.1912, ortho: 0.0000, at: 0.0005, neg: 0.0024
Starting validation...
val - epoch: 54, loss: 0.8608, acc: 0.6719, auc: 0.8873, F1: 0.5263, QWK: 0.6409.
Epoch: 54 | Val AUC: 0.8873 | Test Skipped
epoch: 55, loss: 4.0615, cls: 0.7994, distill: 0.1838, contrast: 4.2981, ortho: 0.0000, at: 0.0005, neg: 0.0021
Starting validation...
val - epoch: 55, loss: 1.0230, acc: 0.6375, auc: 0.8462, F1: 0.3108, QWK: 0.4402.
Epoch: 55 | Val AUC: 0.8462 | Test Skipped
epoch: 56, loss: 3.9822, cls: 0.8643, distill: 0.1611, contrast: 4.0371, ortho: 0.0000, at: 0.0005, neg: 0.0018
Starting validation...
val - epoch: 56, loss: 0.9387, acc: 0.6281, auc: 0.8880, F1: 0.4798, QWK: 0.6036.
Epoch: 56 | Val AUC: 0.8880 | Test Skipped
epoch: 57, loss: 3.8238, cls: 0.7337, distill: 0.1115, contrast: 4.1326, ortho: 0.0000, at: 0.0005, neg: 0.0019
Starting validation...
val - epoch: 57, loss: 0.8007, acc: 0.6656, auc: 0.8914, F1: 0.5577, QWK: 0.6195.
Epoch: 57 | Val AUC: 0.8914 | Test Skipped
epoch: 58, loss: 3.7267, cls: 0.6862, distill: 0.1056, contrast: 4.0940, ortho: 0.0000, at: 0.0005, neg: 0.0018
Starting validation...
val - epoch: 58, loss: 0.9053, acc: 0.6687, auc: 0.8820, F1: 0.4684, QWK: 0.5253.
Epoch: 58 | Val AUC: 0.8820 | Test Skipped
epoch: 59, loss: 3.8130, cls: 0.6808, distill: 0.1388, contrast: 4.1792, ortho: 0.0000, at: 0.0005, neg: 0.0022
Starting validation...
val - epoch: 59, loss: 0.8312, acc: 0.6781, auc: 0.8846, F1: 0.5273, QWK: 0.5557.
Epoch: 59 | Val AUC: 0.8846 | Test Skipped
epoch: 60, loss: 3.8202, cls: 0.6524, distill: 0.1895, contrast: 4.1594, ortho: 0.0186, at: 0.0005, neg: 0.0030
Starting validation...
val - epoch: 60, loss: 0.8482, acc: 0.6594, auc: 0.8876, F1: 0.4844, QWK: 0.5770.
Epoch: 60 | Val AUC: 0.8876 | Test Skipped
epoch: 61, loss: 3.9324, cls: 0.6968, distill: 0.1897, contrast: 4.2508, ortho: 0.0564, at: 0.0005, neg: 0.0070
Starting validation...
val - epoch: 61, loss: 0.8546, acc: 0.6656, auc: 0.8846, F1: 0.4962, QWK: 0.5083.
Epoch: 61 | Val AUC: 0.8846 | Test Skipped
epoch: 62, loss: 3.8616, cls: 0.7494, distill: 0.1185, contrast: 4.0787, ortho: 0.0015, at: 0.0005, neg: 0.0059
Starting validation...
val - epoch: 62, loss: 0.7981, acc: 0.6750, auc: 0.8865, F1: 0.5076, QWK: 0.6093.
Epoch: 62 | Val AUC: 0.8865 | Test Skipped
epoch: 63, loss: 3.8513, cls: 0.6935, distill: 0.1790, contrast: 4.1817, ortho: 0.0007, at: 0.0005, neg: 0.0061
Starting validation...
val - epoch: 63, loss: 0.8374, acc: 0.6562, auc: 0.8773, F1: 0.4096, QWK: 0.5167.
Epoch: 63 | Val AUC: 0.8773 | Test Skipped
epoch: 64, loss: 4.0601, cls: 0.7019, distill: 0.2283, contrast: 4.4071, ortho: 0.0002, at: 0.0005, neg: 0.0074
Starting validation...
val - epoch: 64, loss: 0.8807, acc: 0.6625, auc: 0.8785, F1: 0.4752, QWK: 0.5765.
Epoch: 64 | Val AUC: 0.8785 | Test Skipped
epoch: 65, loss: 3.8941, cls: 0.6781, distill: 0.1714, contrast: 4.2153, ortho: 0.0001, at: 0.0005, neg: 0.0094
Starting validation...
val - epoch: 65, loss: 0.9182, acc: 0.6438, auc: 0.8796, F1: 0.4728, QWK: 0.6018.
Epoch: 65 | Val AUC: 0.8796 | Test Skipped
epoch: 66, loss: 3.9409, cls: 0.6849, distill: 0.2504, contrast: 4.1220, ortho: 0.0002, at: 0.0006, neg: 0.0134
Starting validation...
val - epoch: 66, loss: 0.8436, acc: 0.6781, auc: 0.8893, F1: 0.5134, QWK: 0.6369.
Epoch: 66 | Val AUC: 0.8893 | Test Skipped
epoch: 67, loss: 4.0295, cls: 0.8364, distill: 0.1452, contrast: 4.0826, ortho: 0.0001, at: 0.0005, neg: 0.0143
Starting validation...
val - epoch: 67, loss: 0.8538, acc: 0.6687, auc: 0.8853, F1: 0.5358, QWK: 0.6351.
Epoch: 67 | Val AUC: 0.8853 | Test Skipped
epoch: 68, loss: 3.8015, cls: 0.6828, distill: 0.0887, contrast: 4.1209, ortho: 0.0001, at: 0.0005, neg: 0.0090
Starting validation...
val - epoch: 68, loss: 0.8631, acc: 0.6719, auc: 0.8824, F1: 0.5063, QWK: 0.5231.
Epoch: 68 | Val AUC: 0.8824 | Test Skipped
epoch: 69, loss: 3.9999, cls: 0.7876, distill: 0.1607, contrast: 4.2082, ortho: 0.0001, at: 0.0005, neg: 0.0089
Starting validation...
val - epoch: 69, loss: 0.8349, acc: 0.6531, auc: 0.8888, F1: 0.5658, QWK: 0.6608.
Epoch: 69 | Val AUC: 0.8888 | Test Skipped
epoch: 70, loss: 3.9272, cls: 0.8178, distill: 0.1375, contrast: 4.0690, ortho: 0.0000, at: 0.0005, neg: 0.0097
Starting validation...
val - epoch: 70, loss: 0.8744, acc: 0.6469, auc: 0.8726, F1: 0.3952, QWK: 0.4745.
Epoch: 70 | Val AUC: 0.8726 | Test Skipped
epoch: 71, loss: 3.8481, cls: 0.7569, distill: 0.1630, contrast: 3.9990, ortho: 0.0000, at: 0.0005, neg: 0.0108
Starting validation...
val - epoch: 71, loss: 1.0543, acc: 0.6062, auc: 0.8697, F1: 0.4505, QWK: 0.4935.
Epoch: 71 | Val AUC: 0.8697 | Test Skipped
epoch: 72, loss: 3.9665, cls: 0.7337, distill: 0.1827, contrast: 4.2502, ortho: 0.0000, at: 0.0005, neg: 0.0111
Starting validation...
val - epoch: 72, loss: 0.9144, acc: 0.6375, auc: 0.8814, F1: 0.4733, QWK: 0.6383.
Epoch: 72 | Val AUC: 0.8814 | Test Skipped
epoch: 73, loss: 3.9532, cls: 0.7322, distill: 0.1800, contrast: 4.2477, ortho: 0.0000, at: 0.0005, neg: 0.0086
Starting validation...
val - epoch: 73, loss: 0.7543, acc: 0.6969, auc: 0.8907, F1: 0.5661, QWK: 0.6283.
Epoch: 73 | Val AUC: 0.8907 | Test Skipped
epoch: 74, loss: 3.8607, cls: 0.7221, distill: 0.1500, contrast: 4.1240, ortho: 0.0000, at: 0.0005, neg: 0.0163
Starting validation...
val - epoch: 74, loss: 1.1149, acc: 0.6281, auc: 0.8800, F1: 0.4517, QWK: 0.5193.
Epoch: 74 | Val AUC: 0.8800 | Test Skipped
epoch: 75, loss: 3.9571, cls: 0.6545, distill: 0.2377, contrast: 4.1021, ortho: 0.0000, at: 0.0005, neg: 0.0221
Starting validation...
val - epoch: 75, loss: 0.9186, acc: 0.6469, auc: 0.8635, F1: 0.4372, QWK: 0.5640.
Epoch: 75 | Val AUC: 0.8635 | Test Skipped
epoch: 76, loss: 4.1495, cls: 0.7681, distill: 0.2405, contrast: 4.2131, ortho: 0.0001, at: 0.0006, neg: 0.0129
Starting validation...
val - epoch: 76, loss: 0.8643, acc: 0.6594, auc: 0.8898, F1: 0.5152, QWK: 0.5655.
Epoch: 76 | Val AUC: 0.8898 | Test Skipped
epoch: 77, loss: 3.9625, cls: 0.7729, distill: 0.1131, contrast: 4.1558, ortho: 0.0017, at: 0.0005, neg: 0.0103
Starting validation...
val - epoch: 77, loss: 0.9066, acc: 0.6438, auc: 0.8903, F1: 0.4887, QWK: 0.6240.
Epoch: 77 | Val AUC: 0.8903 | Test Skipped
epoch: 78, loss: 3.9328, cls: 0.7441, distill: 0.1229, contrast: 4.1557, ortho: 0.0002, at: 0.0005, neg: 0.0087
Starting validation...
val - epoch: 78, loss: 0.8294, acc: 0.6719, auc: 0.8783, F1: 0.4211, QWK: 0.5184.
Epoch: 78 | Val AUC: 0.8783 | Test Skipped
epoch: 79, loss: 3.8490, cls: 0.7436, distill: 0.1413, contrast: 4.0587, ortho: 0.0001, at: 0.0005, neg: 0.0090
Starting validation...
val - epoch: 79, loss: 0.8244, acc: 0.6469, auc: 0.8979, F1: 0.4787, QWK: 0.5806.
Epoch: 79 | Val AUC: 0.8979 | Test Skipped
Saving best model...
Best Val AUC: 0.8979 (Model Saved)
epoch: 80, loss: 3.8757, cls: 0.7497, distill: 0.1841, contrast: 3.9809, ortho: 0.0000, at: 0.0005, neg: 0.0079
Starting validation...
val - epoch: 80, loss: 0.8783, acc: 0.6469, auc: 0.8818, F1: 0.4800, QWK: 0.6308.
Epoch: 80 | Val AUC: 0.8818 | Test Skipped
epoch: 81, loss: 3.7287, cls: 0.6947, distill: 0.1176, contrast: 3.9651, ortho: 0.0000, at: 0.0005, neg: 0.0075
Starting validation...
val - epoch: 81, loss: 0.8806, acc: 0.6500, auc: 0.8899, F1: 0.5185, QWK: 0.6310.
Epoch: 81 | Val AUC: 0.8899 | Test Skipped
epoch: 82, loss: 3.8729, cls: 0.7369, distill: 0.1544, contrast: 4.0823, ortho: 0.0000, at: 0.0005, neg: 0.0064
Starting validation...
val - epoch: 82, loss: 0.8633, acc: 0.6719, auc: 0.8925, F1: 0.5136, QWK: 0.5915.
Epoch: 82 | Val AUC: 0.8925 | Test Skipped
epoch: 83, loss: 3.8782, cls: 0.6679, distill: 0.1848, contrast: 4.1438, ortho: 0.0000, at: 0.0005, neg: 0.0059
Starting validation...
val - epoch: 83, loss: 0.8384, acc: 0.6687, auc: 0.8834, F1: 0.4746, QWK: 0.5271.
Epoch: 83 | Val AUC: 0.8834 | Test Skipped
epoch: 84, loss: 3.9143, cls: 0.7268, distill: 0.1524, contrast: 4.0686, ortho: 0.0000, at: 0.0005, neg: 0.0066
Starting validation...
val - epoch: 84, loss: 1.0861, acc: 0.6062, auc: 0.8955, F1: 0.4626, QWK: 0.6585.
Epoch: 84 | Val AUC: 0.8955 | Test Skipped
epoch: 85, loss: 3.8357, cls: 0.7392, distill: 0.1577, contrast: 4.0292, ortho: 0.0000, at: 0.0005, neg: 0.0083
Starting validation...
val - epoch: 85, loss: 0.9516, acc: 0.6562, auc: 0.8684, F1: 0.4164, QWK: 0.4919.
Epoch: 85 | Val AUC: 0.8684 | Test Skipped
epoch: 86, loss: 3.7799, cls: 0.7116, distill: 0.1934, contrast: 3.9019, ortho: 0.0000, at: 0.0005, neg: 0.0101
Starting validation...
val - epoch: 86, loss: 0.8341, acc: 0.6562, auc: 0.8985, F1: 0.4994, QWK: 0.5902.
Epoch: 86 | Val AUC: 0.8985 | Test Skipped
Saving best model...
Best Val AUC: 0.8985 (Model Saved)
epoch: 87, loss: 3.8513, cls: 0.6620, distill: 0.1859, contrast: 4.1238, ortho: 0.0000, at: 0.0005, neg: 0.0093
Starting validation...
val - epoch: 87, loss: 0.9716, acc: 0.6188, auc: 0.8896, F1: 0.4673, QWK: 0.5650.
Epoch: 87 | Val AUC: 0.8896 | Test Skipped
epoch: 88, loss: 3.9570, cls: 0.6920, distill: 0.2308, contrast: 4.1647, ortho: 0.0000, at: 0.0005, neg: 0.0066
Starting validation...
val - epoch: 88, loss: 0.8454, acc: 0.6562, auc: 0.8830, F1: 0.4607, QWK: 0.5799.
Epoch: 88 | Val AUC: 0.8830 | Test Skipped
epoch: 89, loss: 4.0199, cls: 0.7353, distill: 0.2500, contrast: 4.0801, ortho: 0.0000, at: 0.0005, neg: 0.0053
Starting validation...
val - epoch: 89, loss: 0.8695, acc: 0.6531, auc: 0.8959, F1: 0.4996, QWK: 0.5083.
Epoch: 89 | Val AUC: 0.8959 | Test Skipped
epoch: 90, loss: 3.7843, cls: 0.6962, distill: 0.1511, contrast: 3.9945, ortho: 0.0000, at: 0.0005, neg: 0.0099
Starting validation...
val - epoch: 90, loss: 0.8854, acc: 0.6719, auc: 0.8981, F1: 0.5160, QWK: 0.5959.
Epoch: 90 | Val AUC: 0.8981 | Test Skipped
epoch: 91, loss: 3.6857, cls: 0.6801, distill: 0.1144, contrast: 3.9847, ortho: 0.0000, at: 0.0005, neg: 0.0075
Starting validation...
val - epoch: 91, loss: 0.7927, acc: 0.6687, auc: 0.8898, F1: 0.4884, QWK: 0.5997.
Epoch: 91 | Val AUC: 0.8898 | Test Skipped
epoch: 92, loss: 3.6968, cls: 0.6702, distill: 0.1295, contrast: 3.9705, ortho: 0.0000, at: 0.0005, neg: 0.0059
Starting validation...
val - epoch: 92, loss: 0.9535, acc: 0.6781, auc: 0.8966, F1: 0.5010, QWK: 0.5177.
Epoch: 92 | Val AUC: 0.8966 | Test Skipped
epoch: 93, loss: 3.7452, cls: 0.6325, distill: 0.1783, contrast: 4.0167, ortho: 0.0000, at: 0.0005, neg: 0.0068
Starting validation...
val - epoch: 93, loss: 0.8428, acc: 0.6719, auc: 0.8946, F1: 0.5086, QWK: 0.5280.
Epoch: 93 | Val AUC: 0.8946 | Test Skipped
epoch: 94, loss: 3.9939, cls: 0.6787, distill: 0.2873, contrast: 4.1533, ortho: 0.0000, at: 0.0005, neg: 0.0069
Starting validation...
val - epoch: 94, loss: 0.9826, acc: 0.6625, auc: 0.8937, F1: 0.5127, QWK: 0.5366.
Epoch: 94 | Val AUC: 0.8937 | Test Skipped
epoch: 95, loss: 3.9501, cls: 0.6980, distill: 0.2297, contrast: 4.1531, ortho: 0.0000, at: 0.0005, neg: 0.0053
Starting validation...
val - epoch: 95, loss: 0.7882, acc: 0.6875, auc: 0.9028, F1: 0.5406, QWK: 0.5983.
Epoch: 95 | Val AUC: 0.9028 | Test Skipped
Saving best model...
Best Val AUC: 0.9028 (Model Saved)
epoch: 96, loss: 3.9010, cls: 0.6860, distill: 0.1885, contrast: 4.1990, ortho: 0.0000, at: 0.0005, neg: 0.0038
Starting validation...
val - epoch: 96, loss: 0.9529, acc: 0.6562, auc: 0.8975, F1: 0.4688, QWK: 0.5509.
Epoch: 96 | Val AUC: 0.8975 | Test Skipped
epoch: 97, loss: 3.8795, cls: 0.6999, distill: 0.1783, contrast: 4.1024, ortho: 0.0000, at: 0.0005, neg: 0.0047
Starting validation...
val - epoch: 97, loss: 0.8130, acc: 0.6625, auc: 0.8977, F1: 0.5352, QWK: 0.6587.
Epoch: 97 | Val AUC: 0.8977 | Test Skipped
epoch: 98, loss: 3.7706, cls: 0.6588, distill: 0.1398, contrast: 4.0969, ortho: 0.0000, at: 0.0005, neg: 0.0037
Starting validation...
val - epoch: 98, loss: 0.8345, acc: 0.6500, auc: 0.8884, F1: 0.4810, QWK: 0.5358.
Epoch: 98 | Val AUC: 0.8884 | Test Skipped
epoch: 99, loss: 4.0575, cls: 0.7247, distill: 0.2239, contrast: 4.1940, ortho: 0.0000, at: 0.0005, neg: 0.0048
Starting validation...
val - epoch: 99, loss: 1.0401, acc: 0.6250, auc: 0.8809, F1: 0.4571, QWK: 0.5054.
Epoch: 99 | Val AUC: 0.8809 | Test Skipped
epoch: 100, loss: 3.9557, cls: 0.6626, distill: 0.2253, contrast: 4.1757, ortho: 0.0000, at: 0.0005, neg: 0.0054
Starting validation...
val - epoch: 100, loss: 0.9853, acc: 0.6531, auc: 0.8717, F1: 0.4487, QWK: 0.5543.
Epoch: 100 | Val AUC: 0.8717 | Test Skipped
[21:37:00][Rank 3] All epochs finished.[21:37:00][Rank 2] All epochs finished.

[21:37:00][Rank 1] All epochs finished.
[21:37:00][Rank 0] All epochs finished.
Saving Final Checkpoint...
Loading Best Model for Final Testing...
val - epoch: 100, loss: 0.7882, acc: 0.6875, auc: 0.9028, F1: 0.5406, QWK: 0.5983.
test - epoch: 100, loss: 1.3548, acc: 0.3203, auc: 0.8454, F1: 0.3983, QWK: 0.5684.
******************************************
Final Test Performance (Best Model):
AUC   : 0.8454
ACC   : 0.3203
F1    : 0.3983
Kappa : 0.5684
******************************************
Python script finished. Checking checkpoints for status...
Checking directory: ./output_esdg_h100
‚úÖ Found final_model.pth. Training completed successfully.
